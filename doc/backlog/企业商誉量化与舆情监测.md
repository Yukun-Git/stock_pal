# Backlog: 企业商誉量化与舆情监测功能

**创建日期**: 2025-11-13
**优先级**: Low (低)
**预估工作量**: 10-15天
**状态**: Backlog
**标签**: `feature`, `nlp`, `sentiment-analysis`, `web-scraping`, `advanced`

---

## 1. 需求概述

### 1.1 背景

在当前自媒体高度发达、信息传播极为快速的时代，一个企业的"口碑"往往会对企业接下来的产品销量、盈利等产生重大影响。传统的基本面分析和技术面分析往往忽略了这一重要维度。

**典型案例**：
- **鸿星尔克捐款事件** (2021年7月)：河南水灾捐款5000万，微博话题阅读量50亿+，品牌知名度暴增，销售额增长52倍
- **三鹿奶粉事件** (2008年)：三聚氰胺丑闻，负面舆情导致品牌信任崩溃，最终退市
- **比亚迪冠军版** (2024年)：新车型上市，社交媒体讨论热度+200%，正面评价占比85%，销量大增

这些案例说明，**企业舆情/口碑的量化监测**具有重要的投资参考价值。

### 1.2 目标

通过抓取和分析网络上的公开信息，以量化的方式评判企业的口碑变化，为投资决策提供辅助参考。

### 1.3 核心价值

- **差异化功能**：市场上几乎没有竞品提供此功能
- **风险预警**：提前发现负面舆情，规避投资雷区
- **机会捕捉**：识别正面事件驱动的投资机会
- **辅助决策**：结合技术面、基本面、舆情面的三维分析

---

## 2. 用户故事

### US-1: 查看企业商誉评分
**作为** 投资者
**我希望** 看到某只股票的当前商誉评分
**以便** 我可以了解这家企业的口碑状况

**验收标准**:
- 在股票详情页展示商誉评分（0-1分制）
- 显示商誉趋势（与上周/上月对比）
- 显示评分来源（社交媒体、新闻媒体、消费者评价等）
- 数据更新频率至少每日一次

### US-2: 商誉变化提醒
**作为** 投资者
**我希望** 当持仓股票的商誉发生重大变化时收到提醒
**以便** 我可以及时调整仓位

**验收标准**:
- 支持设置商誉变化阈值（如-30%）
- 当商誉指数下降超过阈值时发送提醒
- 提醒包含：变化幅度、主要原因、相关事件
- 支持站内消息和邮件提醒

### US-3: 基于商誉的选股过滤
**作为** 投资者
**我希望** 在选股时过滤掉商誉评分过低的股票
**以便** 我可以规避风险股票

**验收标准**:
- 选股器中添加商誉过滤选项
- 可设置最低商誉得分（如>0.5）
- 可设置最大负面趋势（如<-20%）
- 筛选结果显示商誉评分和风险提示

### US-4: 查看商誉事件时间线
**作为** 投资者
**我希望** 查看企业商誉变化的历史时间线
**以便** 我可以了解哪些事件影响了企业口碑

**验收标准**:
- 可视化展示商誉变化曲线
- 在关键时间点标注重大事件
- 显示每个事件的类型（正面/负面）和影响程度
- 支持至少6个月的历史数据

---

## 3. 功能需求

### 3.1 核心功能

#### F-1: 商誉综合评分

**计算公式**（加权平均）:
```
商誉指数 = w1 × 社交媒体情感 + w2 × 新闻报道倾向 + w3 × 消费者评分 + w4 × 投诉指数

权重建议：
w1 = 0.30  # 社交媒体（雪球、微博）
w2 = 0.25  # 新闻媒体（财经新闻）
w3 = 0.25  # 消费者评价（电商、投诉平台）
w4 = 0.20  # 负面事件（监管处罚、司法诉讼）
```

**评分标准**：
- `[0.7, 1.0]`：口碑优秀（买入信号）
- `[0.4, 0.7]`：口碑正常（中性）
- `[0, 0.4]`：口碑堪忧（风险警示）
- `<0`：严重负面（卖出信号）

#### F-2: 商誉变化趋势

**计算公式**:
```
商誉变化率 = (本周商誉指数 - 上周商誉指数) / 上周商誉指数

信号识别：
- 变化率 < -30%：重大负面事件，考虑减仓/止损
- 变化率 > +30%：重大正面事件，关注买入机会
- -30% ~ +30%：正常波动
```

#### F-3: 事件驱动分析

**事件分类与权重**：

| 事件类型 | 权重 | 持续周期 | 示例 |
|---------|------|---------|------|
| 质量丑闻 | -0.8 | 6-12个月 | 三鹿奶粉、长春长生疫苗 |
| 监管处罚 | -0.6 | 3-6个月 | 证监会立案调查 |
| 产品创新 | +0.7 | 3-6个月 | 华为Mate60、比亚迪仰望 |
| 公益事件 | +0.3 | 1-3个月 | 鸿星尔克捐款事件 |
| 劳资纠纷 | -0.4 | 1-3个月 | 裁员、欠薪 |
| 环保处罚 | -0.5 | 3-6个月 | 污染、违规排放 |

**衰减模型**（事件影响随时间衰减）:
```python
当前影响 = 初始权重 × e^(-λt)  # λ为衰减系数，t为天数
```

#### F-4: 数据源整合

**高价值数据源**：
1. 社交媒体舆情（雪球、东方财富股吧、微博）
2. 新闻媒体报道（财经媒体、权威媒体）
3. 消费者口碑平台（电商评分、投诉平台）
4. 员工口碑（脉脉、看准网）
5. 搜索引擎趋势（百度指数、微信指数）
6. 监管/司法信息（证监会处罚、法院公告）

---

## 4. 数据获取能力详细分析

### 4.1 数据源可行性评估

#### 🟢 高可行性数据源（推荐优先实现）

##### 1. 雪球股吧

**可抓取性**: ⭐⭐⭐⭐⭐
**技术难度**: ⭐⭐
**法律风险**: ⭐（低）
**数据价值**: ⭐⭐⭐⭐

**抓取方式**：
- **官方API**（推荐）：
  ```python
  # 雪球提供部分公开API
  GET https://xueqiu.com/statuses/search.json?q=$贵州茅台&count=20&page=1

  # 返回字段：
  # - id: 帖子ID
  # - text: 帖子内容
  # - created_at: 发布时间
  # - like_count: 点赞数
  # - reply_count: 评论数
  # - user: 发帖用户信息
  ```

- **网页爬虫**（备选）：
  ```python
  # 使用 Selenium + BeautifulSoup
  # 需要处理登录验证（可使用cookie池）
  ```

**反爬虫策略**：
- IP限流：每分钟不超过20次请求
- User-Agent检测：模拟真实浏览器
- 登录验证：需要账号cookie

**绕过方案**：
- 使用代理IP池轮换
- 设置请求间隔（3-5秒）
- 维护多个账号cookie池
- 分布式爬取（多台服务器）

**数据样本**：
```json
{
  "symbol": "SH600519",
  "posts": [
    {
      "id": "123456789",
      "text": "茅台今天又涨了，真是价值投资的典范",
      "created_at": "2025-11-13 09:30:00",
      "like_count": 35,
      "reply_count": 8,
      "sentiment": 0.85  // 后续NLP分析得出
    }
  ],
  "total_count": 2300,
  "avg_sentiment": 0.72
}
```

##### 2. 东方财富股吧

**可抓取性**: ⭐⭐⭐⭐
**技术难度**: ⭐⭐⭐
**法律风险**: ⭐（低）
**数据价值**: ⭐⭐⭐⭐

**抓取方式**：
```python
# 东方财富股吧API
GET http://guba.eastmoney.com/list,{股票代码}_1.html

# 返回HTML，需解析：
# - 帖子标题、内容
# - 阅读量、评论数
# - 发布时间
```

**反爬虫策略**：
- 强反爬（需要突破JavaScript混淆）
- 需要解析动态加载内容

**绕过方案**：
- 使用 Selenium 模拟浏览器
- 或使用 Puppeteer（无头浏览器）
- 解析加密的API接口（需要逆向分析）

##### 3. 百度指数

**可抓取性**: ⭐⭐⭐
**技术难度**: ⭐⭐⭐⭐
**法律风险**: ⭐⭐（中）
**数据价值**: ⭐⭐⭐⭐

**抓取方式**：
- **官方API**（付费）：
  ```python
  # 百度指数开放平台
  # 需要企业认证 + 付费购买
  # 价格：约 3000-5000元/年
  ```

- **网页爬虫**（免费但复杂）：
  ```python
  # 百度指数网页加密严重
  # 需要逆向JS解密算法
  # 难度较高，不推荐
  ```

**替代方案**：
- 使用第三方数据服务商（如艾瑞、TalkingData）
- 或仅作为付费增值功能

##### 4. 新闻媒体RSS源

**可抓取性**: ⭐⭐⭐⭐⭐
**技术难度**: ⭐
**法律风险**: ⭐（低，公开数据）
**数据价值**: ⭐⭐⭐⭐

**数据源列表**：
```python
RSS_FEEDS = {
    '新浪财经': 'http://finance.sina.com.cn/roll/index.d.html',
    '财联社': 'https://www.cls.cn/telegraph',
    '证券时报': 'http://news.stcn.com/',
    '第一财经': 'https://www.yicai.com/',
}
```

**抓取方式**：
```python
import feedparser

def fetch_news(rss_url):
    feed = feedparser.parse(rss_url)
    articles = []
    for entry in feed.entries:
        articles.append({
            'title': entry.title,
            'summary': entry.summary,
            'published': entry.published,
            'link': entry.link
        })
    return articles
```

**优点**：
- 公开、合法、稳定
- 数据结构化，易于解析
- 无需处理反爬虫

**缺点**：
- 信息更新频率有限（通常每小时更新）
- 需要进一步提取与股票相关的新闻

##### 5. 电商平台评分（京东/天猫）

**可抓取性**: ⭐⭐⭐
**技术难度**: ⭐⭐⭐⭐
**法律风险**: ⭐⭐（中）
**数据价值**: ⭐⭐⭐

**抓取方式**：
```python
# 京东商品评分API（非官方）
GET https://club.jd.com/comment/productPageComments.action?productId={商品ID}

# 返回：
# - 评分（5星制）
# - 好评率
# - 评论数量
# - 最新评论
```

**反爬虫策略**：
- 需要登录
- IP限流严格
- 数据加密

**绕过方案**：
- 使用账号池
- 代理IP池
- 限制爬取频率

**适用场景**：
- 仅适用于有实体产品的公司（如比亚迪、茅台、格力等）
- 不适用于金融、软件类公司

##### 6. 黑猫投诉平台

**可抓取性**: ⭐⭐⭐⭐
**技术难度**: ⭐⭐
**法律风险**: ⭐（低）
**数据价值**: ⭐⭐⭐⭐

**抓取方式**：
```python
# 黑猫投诉搜索API
GET https://tousu.sina.com.cn/api/company/search?keyword={公司名称}

# 返回：
# - 投诉总量
# - 已解决/未解决数量
# - 最近投诉列表
# - 投诉类型分布
```

**数据样本**：
```json
{
  "symbol": "002594",  // 比亚迪
  "company_name": "比亚迪汽车",
  "complaint_count": 350,
  "complaint_trend": "+45%",  // vs 上月
  "resolved_rate": 0.68,
  "top_complaints": [
    {"type": "质量问题", "count": 120},
    {"type": "售后服务", "count": 85}
  ]
}
```

---

#### 🟡 中等可行性数据源（需要额外成本）

##### 7. 微博

**可抓取性**: ⭐⭐⭐
**技术难度**: ⭐⭐⭐⭐
**法律风险**: ⭐⭐（中）
**数据价值**: ⭐⭐⭐⭐⭐

**抓取方式**：
- **官方API**（推荐）：
  ```python
  # 微博开放平台
  # 需要企业认证 + 审核
  # 免费额度：1000次/天
  # 付费：约 10000元/年（不限量）
  ```

- **网页爬虫**（风险高）：
  - 反爬虫极强（IP封禁、账号封禁）
  - 需要大量账号池
  - 不推荐

**替代方案**：
- 仅抓取热搜榜（相对容易）
- 或使用第三方舆情监测服务（如新榜、清博）

##### 8. 脉脉/看准网（员工口碑）

**可抓取性**: ⭐⭐
**技术难度**: ⭐⭐⭐⭐
**法律风险**: ⭐⭐⭐（高）
**数据价值**: ⭐⭐⭐

**限制因素**：
- 需要登录（手机验证）
- 反爬虫严格
- 数据敏感（涉及隐私）

**不推荐理由**：
- 法律风险较高（可能违反《个人信息保护法》）
- 技术难度大
- 性价比低

**替代方案**：
- 使用公开的招聘信息（Boss直聘、拉勾网）
  - 招聘岗位数量 → 公司扩张/收缩信号
  - 薪资范围 → 行业竞争力

---

#### 🔴 低可行性数据源（不推荐）

##### 9. 抖音/B站（短视频平台）

**可抓取性**: ⭐
**技术难度**: ⭐⭐⭐⭐⭐
**法律风险**: ⭐⭐⭐（高）
**数据价值**: ⭐⭐⭐

**不推荐理由**：
- 反爬虫极强（加密算法复杂）
- 需要逆向APP接口（违反用户协议）
- 法律风险高
- 视频内容NLP分析难度极大

**替代方案**：
- 仅抓取热榜/话题榜（相对简单）
- 或手动监测重大事件

---

### 4.2 数据获取能力总结

#### MVP版本（2周内可实现）

**推荐数据源**：
1. ✅ **雪球股吧**（核心数据源）
2. ✅ **财经新闻RSS**（辅助数据源）
3. ✅ **黑猫投诉**（风险预警）

**技术方案**：
```python
# 1. 雪球帖子爬虫
def crawl_xueqiu_posts(symbol, days=7):
    """爬取雪球最近N天的帖子"""
    url = f"https://xueqiu.com/statuses/search.json"
    params = {'q': f'${symbol}', 'count': 100, 'page': 1}
    headers = {
        'User-Agent': 'Mozilla/5.0...',
        'Cookie': XUEQIU_COOKIE  # 从配置文件读取
    }
    response = requests.get(url, params=params, headers=headers)
    return response.json()

# 2. 新闻RSS抓取
def fetch_financial_news(keyword, days=7):
    """抓取财经新闻"""
    import feedparser
    feed = feedparser.parse('http://finance.sina.com.cn/roll/index.d.html')
    articles = [entry for entry in feed.entries if keyword in entry.title]
    return articles

# 3. 黑猫投诉查询
def fetch_complaints(company_name):
    """查询黑猫投诉数量"""
    url = f"https://tousu.sina.com.cn/api/company/search"
    params = {'keyword': company_name}
    response = requests.get(url, params=params)
    return response.json()
```

#### 完整版本（1-2个月）

**扩展数据源**：
4. ✅ 东方财富股吧
5. ✅ 百度指数（付费API）
6. ⚠️ 微博热搜（仅热榜）
7. ⚠️ 电商评分（仅部分公司）

---

### 4.3 法律与合规分析

#### ✅ 合法合规的抓取方式

1. **使用官方API**：
   - 雪球、微博、百度等提供的官方开放平台
   - 遵守API调用频率限制
   - 付费使用商业数据服务

2. **抓取公开数据**：
   - RSS订阅源（公开发布）
   - 新闻网站（公开信息）
   - 政府公示数据（证监会、法院公告）

3. **遵守 robots.txt**：
   ```python
   # 检查网站的爬虫协议
   import urllib.robotparser
   rp = urllib.robotparser.RobotFileParser()
   rp.set_url("https://xueqiu.com/robots.txt")
   rp.read()
   can_fetch = rp.can_fetch("*", "/statuses/search.json")
   ```

#### ⚠️ 灰色地带（需谨慎）

1. **爬取需要登录的内容**：
   - 技术上可行，但可能违反用户协议
   - 建议：仅爬取公开内容，或使用官方API

2. **大规模爬取**：
   - 可能被视为DDOS攻击
   - 建议：控制频率（每秒不超过1次请求）

#### ❌ 违法风险高（禁止）

1. **爬取个人隐私数据**：
   - 用户手机号、身份证、地址等
   - 违反《个人信息保护法》

2. **突破技术保护措施**：
   - 破解验证码、绕过登录验证
   - 可能构成非法入侵计算机系统

3. **商业数据转售**：
   - 未经授权转售爬取的数据
   - 违反《反不正当竞争法》

---

### 4.4 数据获取架构设计

#### 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                    定时任务调度器                        │
│                   (APScheduler)                         │
└────────────────────┬────────────────────────────────────┘
                     │
         ┌───────────┴───────────┐
         │                       │
    ┌────▼────┐            ┌────▼────┐
    │ 爬虫池   │            │ API池   │
    │ (雪球等) │            │(百度指数)│
    └────┬────┘            └────┬────┘
         │                       │
         └───────────┬───────────┘
                     │
              ┌──────▼──────┐
              │  数据清洗    │
              │  (去重/格式化)│
              └──────┬──────┘
                     │
              ┌──────▼──────┐
              │  NLP引擎    │
              │ (情感分析)   │
              └──────┬──────┘
                     │
              ┌──────▼──────┐
              │  数据存储    │
              │ (时序数据库) │
              └─────────────┘
```

#### 定时任务设计

```python
from apscheduler.schedulers.background import BackgroundScheduler

scheduler = BackgroundScheduler()

# 每天凌晨1点：爬取昨日雪球帖子
scheduler.add_job(
    func=crawl_xueqiu_all_stocks,
    trigger='cron',
    hour=1,
    minute=0
)

# 每2小时：更新新闻RSS
scheduler.add_job(
    func=fetch_news_feeds,
    trigger='interval',
    hours=2
)

# 每周一：更新黑猫投诉数据
scheduler.add_job(
    func=update_complaint_data,
    trigger='cron',
    day_of_week='mon',
    hour=2
)

scheduler.start()
```

#### 数据存储设计

**时序数据库**（推荐 InfluxDB）：

```python
# 商誉指数时序数据
{
    "measurement": "reputation_score",
    "tags": {
        "symbol": "SH600519",
        "source": "xueqiu"
    },
    "time": "2025-11-13T00:00:00Z",
    "fields": {
        "score": 0.75,
        "sentiment": 0.72,
        "volume": 2300,
        "positive_rate": 0.68
    }
}

# 事件数据
{
    "measurement": "reputation_events",
    "tags": {
        "symbol": "SH600519",
        "event_type": "product_launch"
    },
    "time": "2025-11-13T09:30:00Z",
    "fields": {
        "impact": 0.15,
        "description": "新品发布会",
        "sentiment": 0.88
    }
}
```

---

### 4.5 成本估算

#### 开发成本

| 阶段 | 工作内容 | 工作量 | 人力成本 |
|-----|---------|--------|---------|
| 阶段1 | 雪球爬虫开发 | 2天 | 2人日 |
| 阶段2 | NLP情感分析 | 3天 | 3人日 |
| 阶段3 | 数据存储与API | 2天 | 2人日 |
| 阶段4 | 前端展示 | 2天 | 2人日 |
| 阶段5 | 测试与优化 | 1天 | 1人日 |
| **总计** | | **10天** | **10人日** |

#### 运营成本（每月）

| 项目 | 说明 | 费用 |
|-----|------|------|
| 服务器 | 1台爬虫服务器（2核4G） | ¥100 |
| 代理IP | IP池（1000个/月） | ¥200 |
| 百度指数API | 企业版（可选） | ¥250 |
| 时序数据库 | InfluxDB Cloud | ¥50 |
| NLP API | 百度AI/腾讯云（5万次/天） | ¥0（免费额度） |
| **总计** | | **¥600/月** |

**年度成本**：约 ¥7,200

---

## 5. 技术方案

### 5.1 情感分析方案

#### 方案1: 调用现成API（推荐MVP）

**百度AI情感倾向分析**：
```python
from aip import AipNlp

APP_ID = 'your_app_id'
API_KEY = 'your_api_key'
SECRET_KEY = 'your_secret_key'

client = AipNlp(APP_ID, API_KEY, SECRET_KEY)

def analyze_sentiment(text):
    result = client.sentimentClassify(text)
    # 返回：
    # - sentiment: 0(负面), 1(中性), 2(正面)
    # - confidence: 置信度
    # - positive_prob: 正面概率
    # - negative_prob: 负面概率
    return result
```

**优点**：
- 快速实现，无需训练模型
- 准确率较高（~85%）
- 免费额度充足（5万次/天）

**缺点**：
- 对金融领域专业术语支持一般
- 依赖外部服务（网络延迟）

#### 方案2: 开源NLP库（成本低）

**SnowNLP**（中文情感分析）：
```python
from snownlp import SnowNLP

def analyze_sentiment(text):
    s = SnowNLP(text)
    return s.sentiments  # 返回 [0, 1]，>0.5为正面

# 示例
text1 = "茅台今天又涨了,真是价值投资的典范"
score1 = analyze_sentiment(text1)  # 0.89 (正面)

text2 = "这家公司财务造假，太坑了"
score2 = analyze_sentiment(text2)  # 0.12 (负面)
```

**优点**：
- 完全免费、本地运行
- 无网络依赖
- 速度快

**缺点**：
- 准确率一般（~75%）
- 对金融术语支持弱

#### 方案3: 预训练模型（高级）

**FinBERT-Chinese**（金融领域BERT）：
```python
from transformers import BertTokenizer, BertForSequenceClassification
import torch

model_name = "FinBERT-Chinese"
tokenizer = BertTokenizer.from_pretrained(model_name)
model = BertForSequenceClassification.from_pretrained(model_name)

def analyze_sentiment(text):
    inputs = tokenizer(text, return_tensors="pt", padding=True, truncation=True)
    outputs = model(**inputs)
    probs = torch.softmax(outputs.logits, dim=-1)
    # 返回：[负面概率, 中性概率, 正面概率]
    return probs.detach().numpy()[0]
```

**优点**：
- 准确率高（~90%）
- 专门针对金融领域优化
- 可自定义微调

**缺点**：
- 需要GPU加速（CPU较慢）
- 模型文件较大（~1GB）
- 实现复杂度高

**推荐方案**：
- **MVP阶段**：使用方案1（百度AI API）
- **正式上线**：使用方案3（FinBERT-Chinese）

---

### 5.2 与回测系统整合

#### 整合场景1: 选股过滤器

```python
# backend/app/services/scan_service.py

def scan_stocks_with_reputation(strategy, reputation_filter):
    """选股时过滤掉低商誉股票"""

    # 1. 基于策略筛选候选股票
    candidates = scan_by_strategy(strategy)

    # 2. 获取商誉评分
    for candidate in candidates:
        reputation = get_reputation_score(candidate['symbol'])
        candidate['reputation_score'] = reputation['score']
        candidate['reputation_trend'] = reputation['trend']

    # 3. 过滤低商誉股票
    if reputation_filter:
        min_score = reputation_filter.get('min_score', 0.3)
        max_negative_trend = reputation_filter.get('max_negative_trend', -0.3)

        candidates = [c for c in candidates if
                      c['reputation_score'] >= min_score and
                      c['reputation_trend'] >= max_negative_trend]

    return candidates
```

#### 整合场景2: 风险提示

```python
# backend/app/api/v1/backtest.py

@api.route('/backtest', methods=['POST'])
def run_backtest():
    # 执行回测
    result = backtest_service.run(...)

    # 新增：商誉风险检查
    reputation = reputation_service.get_score(symbol)

    warnings = []
    if reputation['score'] < 0.3:
        warnings.append({
            'type': 'reputation_risk',
            'level': 'high',
            'message': f"该股票商誉评分较低({reputation['score']:.2f})，存在负面舆情风险"
        })

    if reputation['trend'] < -0.3:
        warnings.append({
            'type': 'reputation_decline',
            'level': 'medium',
            'message': f"近期商誉下降{abs(reputation['trend'])*100:.1f}%，建议谨慎"
        })

    result['warnings'] = warnings
    return jsonify(result)
```

#### 整合场景3: 次日计划增强

```python
# API: POST /api/v1/plan

{
  "symbol": "SH600519",
  "entry_range": {"lower": 1800, "upper": 1850},
  "position_suggested": 0.2,
  "stop_loss": 1700,

  # 新增：商誉信息
  "reputation": {
    "score": 0.78,
    "trend": "+15%",
    "risk_level": "low",
    "recent_events": [
      {"date": "2025-11-10", "type": "product_launch", "impact": "+0.1"}
    ],
    "notes": "商誉良好，近期正面报道增多"
  }
}
```

---

### 5.3 前端展示设计

#### 界面1: 商誉卡片（股票详情页）

```
┌──────────────────────────────────────────────────────┐
│  📊 贵州茅台 (600519) - 商誉分析                      │
├──────────────────────────────────────────────────────┤
│  综合评分：★★★★☆ (0.78/1.0)                         │
│  趋势：↑ +15% (vs 上周)                              │
│                                                      │
│  📈 讨论热度：中等 (2300条/周)                        │
│  💬 情感倾向：72% 正面 | 18% 负面 | 10% 中性         │
│  ⚠️  风险提示：无重大负面事件                         │
│                                                      │
│  [查看事件时间线] [设置提醒]                          │
│                                                      │
│  数据来源：雪球、东方财富股吧                         │
│  更新时间：2025-11-13 09:30                          │
└──────────────────────────────────────────────────────┘
```

#### 界面2: 商誉事件时间线

```
┌──────────────────────────────────────────────────────┐
│  📅 商誉变化时间线                                    │
├──────────────────────────────────────────────────────┤
│  2024-10  ━━●━━━━━━━━━━━━━  商誉 0.65               │
│             │                                        │
│             └─ 新车型发布 (+0.1)                      │
│                                                      │
│  2024-11  ━━━━━●━━━━━━━━━  商誉 0.55               │
│                 │                                    │
│                 └─ 召回事件 (-0.1)                    │
│                                                      │
│  2024-12  ━━━━━━━━━●━━━━━  商誉 0.75               │
│                     │                                │
│                     └─ 获行业大奖 (+0.2)              │
│                                                      │
│  2025-01  ━━━━━━━━━━━●━━━  商誉 0.78               │
│                       │                              │
│                       └─ 正面报道增多 (+0.03)         │
└──────────────────────────────────────────────────────┘
```

---

## 6. 实施计划

### 阶段0: 可行性验证（1周，推荐先做）

**目标**：快速验证商誉指数与股价的相关性

**任务**：
- 手动收集10只股票的雪球帖子（复制粘贴）
- 使用SnowNLP做情感分析
- 计算商誉指数
- 对比商誉变化与股价走势
- **产出**：可行性报告（决定是否继续开发）

### 阶段1: MVP开发（2周）

#### 第1周：数据获取与分析
- 雪球爬虫开发（2天）
- 新闻RSS抓取（1天）
- 情感分析集成（百度AI API）（1天）
- 商誉指数计算（1天）

#### 第2周：系统整合与展示
- 数据存储设计（时序数据库）（1天）
- API开发（商誉查询接口）（2天）
- 前端商誉卡片展示（2天）
- 测试与优化（1天）

**交付物**：
- 商誉评分查询API
- 股票详情页展示商誉卡片
- 支持雪球+新闻两个数据源

### 阶段2: 功能完善（2周）

- 黑猫投诉数据整合（2天）
- 东方财富股吧爬虫（2天）
- 商誉变化提醒功能（2天）
- 选股器中的商誉过滤（2天）
- 商誉事件时间线（2天）

### 阶段3: 高级功能（3周，可选）

- 百度指数整合（付费API）（3天）
- 电商评分抓取（部分公司）（3天）
- 商誉-股价相关性分析（4天）
- NLP模型升级（FinBERT-Chinese）（5天）
- 性能优化与分布式爬虫（3天）

---

## 7. 验收标准

### 功能验收（MVP）

- 可查询任意A股股票的商誉评分
- 评分基于至少2个数据源（雪球+新闻）
- 数据更新频率：每日一次
- 前端展示商誉卡片（评分、趋势、热度）
- 支持商誉变化提醒（下降>30%）

### 性能验收

- 商誉查询响应时间 < 500ms
- 爬虫爬取单只股票数据 < 10s
- NLP情感分析处理1000条帖子 < 30s
- 支持至少500只A股的商誉监测

### 准确性验证

- 人工标注100条样本，情感分析准确率 > 80%
- 商誉指数与股价变化相关性 > 0.5（皮尔逊系数）
- 重大负面事件（如召回、处罚）检出率 > 90%

---

## 8. 风险与依赖

### 风险

1. **数据获取风险**：
   - **IP封禁**：爬虫被目标网站封禁
   - **缓解**：使用代理IP池、控制爬取频率

2. **准确性风险**：
   - **情感分析误判**：讽刺、反话识别困难
   - **缓解**：使用金融领域模型、人工校验样本

3. **因果关系不明确**：
   - **商誉好≠股价涨**：可能存在滞后性或无关
   - **缓解**：仅作为辅助参考，不作为主要信号

4. **法律合规风险**：
   - **数据使用合规性**：可能违反网站用户协议
   - **缓解**：优先使用官方API、公开数据

### 依赖

1. **外部服务**：
   - 百度AI API（情感分析）
   - 时序数据库（InfluxDB）
   - 代理IP服务商

2. **数据源稳定性**：
   - 雪球API可能变更
   - 需要持续维护爬虫

3. **计算资源**：
   - 如使用本地NLP模型，需要GPU服务器

---

## 9. 未来扩展

### 短期（1-2月）

- 增加更多数据源（知乎、微信指数）
- 商誉与股价相关性回测验证
- 商誉排行榜（行业内对比）

### 中期（3-6月）

- 事件自动识别（用AI提取关键事件）
- 商誉预测（基于历史数据预测未来趋势）
- 行业商誉分析（行业整体口碑）

### 长期（6-12月）

- 实时舆情监控（分钟级更新）
- 商誉驱动的量化策略（舆情因子）
- 跨市场商誉对比（A股 vs 港股 vs 美股）

---

## 10. 成功指标

### 业务指标

- **使用率**：30%+ 的用户查看商誉分析
- **提醒准确性**：商誉预警后7日内股价下跌概率 > 60%
- **用户反馈**：商誉功能满意度 > 4.0/5.0

### 技术指标

- **数据覆盖率**：覆盖沪深A股 80%+ 的股票
- **数据新鲜度**：数据延迟 < 24小时
- **系统稳定性**：爬虫成功率 > 95%

---

## 11. 参考资料

### 技术文档
- SnowNLP官方文档: https://github.com/isnowfy/snownlp
- 百度AI情感分析API: https://ai.baidu.com/tech/nlp_basic/sentiment_classify
- FinBERT-Chinese: https://huggingface.co/ProsusAI/finbert

### 竞品参考
- 同花顺问财AI选股
- 东方财富妙想AI大模型
- 雪球组合管理

### 学术论文
- "Social Media Sentiment and Stock Returns" (2013)
- "Predicting Stock Market Movements Using Social Media" (2016)

---

## 12. 优先级建议

### 当前优先级：**Low（低）**

**理由**：
1. **核心功能优先**：当前应优先完成回测、选股、提醒等核心功能
2. **技术复杂度高**：涉及爬虫、NLP、时序数据库，开发成本高
3. **有效性待验证**：商誉与股价的因果关系需要先验证
4. **运营成本**：需要持续维护爬虫和数据源

### 建议实施时机

**阶段0验证**（1周）：
- 时机：核心功能开发完成后（3-6个月后）
- 目的：快速验证商誉指数的有效性
- 决策：根据验证结果决定是否继续开发

**MVP开发**（2周）：
- 时机：产品已稳定运营，用户量达到1000+
- 目的：作为差异化功能，提升用户粘性
- 定位：高级/付费功能

---

## 13. 总结

**企业商誉量化功能**是一个：
- ✅ **有价值**的差异化功能（市场空白）
- ⚠️ **有挑战**的技术方案（爬虫、NLP、合规）
- 🎯 **需验证**的业务假设（商誉 → 股价）

**建议**：
1. 短期（现在）：**不做**，专注核心功能
2. 中期（3-6月后）：**先验证**，手动测试可行性
3. 长期（6-12月后）：**再开发**，作为高级功能

**如果一定要做**：
- 优先级：Low → Medium（可行性验证通过后）
- 实施方案：阶段0验证（1周） → 决策 → MVP开发（2周）
- 数据源：雪球（核心） + 新闻RSS（辅助） + 黑猫投诉（风控）

---

**状态变更记录**:
- 2025-11-13: 创建 backlog，状态为 `Backlog`，优先级为 `Low`
