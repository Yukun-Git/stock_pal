# 散户常用技术指标与交易方法论

## 概述
本文档总结了中国A股市场散户投资者最常使用的技术分析指标和交易方法论，为量化回测系统的开发提供理论基础。

---

## 一、K线（蜡烛图）理论

### 基本概念
- **单根K线**：实体、上下影线、阳线/阴线
- **组合K线形态**：
  - 看涨形态：早晨之星、红三兵、锤子线、启明星
  - 看跌形态：黄昏之星、三只乌鸦、上吊线、射击之星
  - 中继形态：十字星、孕线、平顶底

### 常见应用
- 底部反转信号识别
- 顶部见顶信号判断
- 趋势延续确认

---

## 二、均线系统（Moving Average）

### 常用均线周期
- **短期**：MA5（5日线）、MA10（10日线）
- **中期**：MA20（20日线）、MA30（30日线）、MA60（60日线）
- **长期**：MA120（半年线）、MA250（年线）

### 核心理论
1. **葛兰碧八大法则**
   - 买入信号4条
   - 卖出信号4条

2. **均线多头/空头排列**
   - 多头排列：短期均线 > 中期均线 > 长期均线
   - 空头排列：短期均线 < 中期均线 < 长期均线

3. **金叉/死叉**
   - 金叉：短期均线上穿长期均线（买入信号）
   - 死叉：短期均线下穿长期均线（卖出信号）
   - 常见组合：5日线与10日线、5日线与20日线、10日线与30日线

4. **均线支撑/压力**
   - 股价回踩均线不破视为支撑
   - 股价反弹受阻于均线视为压力

---

## 三、量价理论

### 核心原理
"量在价先"——成交量是股价变动的先行指标

### 经典量价关系
1. **量价齐升**：上涨趋势健康，可持续
2. **量价背离**：
   - 价涨量缩：上涨动能不足，警惕见顶
   - 价跌量增：恐慌性抛售，可能接近底部
3. **地量地价**：成交极度萎缩，往往是阶段性底部
4. **天量天价**：放出历史巨量，往往是阶段性顶部
5. **缩量上涨/下跌**：
   - 缩量上涨：主力控盘，惜售
   - 缩量下跌：抛压减轻

### 量能指标
- **成交量（VOL）**：柱状图
- **成交额**：资金流动规模
- **换手率**：活跃度指标
  - 高换手率（>7%）：活跃或变盘
  - 低换手率（<1%）：冷门或锁仓

---

## 四、MACD指标（指数平滑异同移动平均线）

### 构成要素
- **DIF（快线）**：短期EMA - 长期EMA（通常12日-26日）
- **DEA（慢线/信号线）**：DIF的9日EMA
- **MACD柱**：(DIF - DEA) × 2

### 经典用法
1. **金叉/死叉**
   - DIF上穿DEA：金叉，买入信号
   - DIF下穿DEA：死叉，卖出信号

2. **零轴上下**
   - 零轴上方：多头市场
   - 零轴下方：空头市场

3. **背离**
   - 顶背离：股价创新高，MACD不创新高→卖出
   - 底背离：股价创新低，MACD不创新低→买入

4. **红绿柱变化**
   - 红柱增长：多头力量增强
   - 绿柱缩短：空头力量减弱

---

## 五、KDJ指标（随机指标）

### 参数设置
- 默认参数：N=9, M1=3, M2=3
- K值（快速线）、D值（慢速线）、J值（方向敏感线）

### 应用法则
1. **数值区间**
   - 超买区：K值 > 80，D值 > 70
   - 超卖区：K值 < 20，D值 < 30

2. **金叉/死叉**
   - K线上穿D线：金叉，买入
   - K线下穿D线：死叉，卖出

3. **背离**
   - 顶背离：股价新高，KDJ不创新高
   - 底背离：股价新低，KDJ不创新低

4. **钝化现象**
   - 强势股在高位钝化
   - 弱势股在低位钝化

---

## 六、RSI指标（相对强弱指标）

### 参数设置
- 常用周期：6日、12日、24日

### 判断标准
1. **强弱区间**
   - RSI > 80：超买，考虑卖出
   - RSI < 20：超卖，考虑买入
   - 50为强弱分界线

2. **背离信号**
   - 顶背离：价格新高，RSI不创新高
   - 底背离：价格新低，RSI不创新低

3. **形态分析**
   - RSI的支撑线和压力线
   - RSI的头肩顶/底等形态

---

## 七、布林带（BOLL）

### 构成
- **中轨**：N日移动平均线（通常20日）
- **上轨**：中轨 + K倍标准差（通常2倍）
- **下轨**：中轨 - K倍标准差

### 应用规则
1. **轨道突破**
   - 突破上轨：强势信号，但可能超买
   - 跌破下轨：弱势信号，但可能超卖

2. **收口与开口**
   - 收口：波动率降低，酝酿变盘
   - 开口：波动率增大，趋势启动

3. **中轨作用**
   - 多头市场：中轨为支撑
   - 空头市场：中轨为压力

4. **经典策略**
   - 布林带突破策略
   - 布林带回归策略（均值回归）

---

## 八、支撑位与压力位

### 识别方法
1. **历史价格**
   - 前期高点/低点
   - 密集成交区
   - 整数关口（如10元、20元）

2. **均线位置**
   - 重要均线（如60日、120日、250日线）

3. **技术形态**
   - 颈线位
   - 箱体上下沿
   - 缺口位置

### 应用
- 支撑位附近考虑买入
- 压力位附近考虑卖出
- 支撑压力相互转换

---

## 九、趋势线与通道

### 趋势线绘制
- **上升趋势线**：连接两个或以上的低点
- **下降趋势线**：连接两个或以上的高点

### 有效性判断
- 被触及次数越多，越有效
- 持续时间越长，越可靠
- 角度适中（30-60度）

### 通道交易
- 上升通道：低吸高抛
- 下降通道：反弹即卖
- 突破通道：趋势加速或反转

---

## 十、经典形态学

### 反转形态
1. **头肩顶/头肩底**
   - 三个峰/谷，中间最高/低
   - 颈线突破确认反转

2. **双顶（M头）/双底（W底）**
   - 两个相近的高点/低点
   - 突破颈线确认

3. **三重顶/三重底**
   - 三个相近的高点/低点

4. **圆弧顶/圆弧底**
   - 缓慢反转形态

### 整理形态
1. **三角形整理**
   - 上升三角形：看涨
   - 下降三角形：看跌
   - 对称三角形：方向不明

2. **矩形整理（箱体）**
   - 在固定区间震荡

3. **旗形/楔形**
   - 短期整理形态

---

## 十一、缺口理论

### 缺口类型
1. **普通缺口**：短期内回补，意义不大
2. **突破缺口**：突破重要阻力/支撑，不易回补
3. **持续缺口（中继缺口）**：趋势中段，测量意义
4. **衰竭缺口**：趋势末端，即将反转

### 应用
- 缺口通常具有支撑/压力作用
- "三日不补，必有后市"
- 岛形反转（缺口 + 反向缺口）

---

## 十二、波浪理论（艾略特波浪）

### 基本结构
- **推动浪**：5浪（1、2、3、4、5浪）
- **调整浪**：3浪（A、B、C浪）

### 核心规则
1. 第3浪不能是最短的浪
2. 第2浪不能跌破第1浪起点
3. 第4浪不能与第1浪重叠（除特殊情况）

### 应用难点
- 浪级划分主观性强
- 实盘中数浪困难
- 散户通常简化使用

---

## 十三、筹码分布理论

### 核心指标
1. **筹码峰**
   - 单峰密集：筹码集中，容易形成趋势
   - 多峰密集：筹码分散，震荡市

2. **获利盘比例**
   - 90%以上获利：警惕获利回吐
   - 大部分套牢：可能接近底部

3. **成本均线**
   - 市场平均持仓成本

### 应用
- 底部单峰密集后向上突破：启动信号
- 高位密集区：压力位
- 低位密集区：支撑位

---

## 十四、资金流向分析

### 核心指标
1. **主力资金流向**
   - 大单买入/卖出
   - 机构持仓变化

2. **DDX/DDY/DDZ**
   - DDX：大单动向
   - DDY：涨跌动因
   - DDZ：大单差分

3. **北向资金/南向资金**
   - 外资流向（沪深港通）

### 应用
- 主力资金持续流入：看涨
- 主力资金持续流出：看跌
- 资金与股价背离：警惕

---

## 十五、其他常用指标

### 1. OBV（能量潮）
- 累计成交量指标
- 量价配合分析

### 2. CCI（顺势指标）
- 超买超卖判断
- 参数通常为14

### 3. 威廉指标（WR）
- 超买超卖判断
- 与KDJ类似

### 4. SAR（抛物线指标）
- 止损点设置
- 趋势追踪

### 5. DMI/ADX（趋向指标）
- 趋势强度判断
- +DI、-DI、ADX

---

## 十六、组合策略示例

### 策略1：均线+MACD组合
```
条件：
1. 5日均线上穿20日均线（金叉）
2. MACD DIF上穿DEA（金叉）
3. 成交量放大
→ 买入信号
```

### 策略2：KDJ+RSI组合
```
条件：
1. KDJ在低位（<20）金叉
2. RSI突破30
3. 股价站上5日均线
→ 买入信号
```

### 策略3：形态+量价组合
```
条件：
1. 双底形态形成
2. 突破颈线
3. 放量突破
4. MACD零轴上方金叉
→ 买入信号
```

### 策略4：趋势跟踪策略
```
条件：
1. 股价站稳20日均线
2. 均线多头排列
3. MACD在零轴上方
4. 每次回踩20日均线加仓
→ 持续持有
```

### 策略5：突破回踩策略
```
条件：
1. 突破前期高点
2. 回踩突破位不破
3. 再次放量上攻
→ 买入信号
```

---

## 十七、散户常见交易心法

### 顺势交易
- "趋势是你的朋友"
- 不抄底，不猜顶
- 等待趋势确认后介入

### 止损原则
- 固定比例止损（如-5%、-8%）
- 技术位止损（跌破支撑位）
- 时间止损（持有N天不涨即卖）

### 资金管理
- 分批建仓
- 金字塔加仓法
- 不满仓操作
- 止盈止损纪律

### 情绪控制
- 避免追涨杀跌
- 不因小利而喜，不因小亏而悲
- 严格执行交易计划

---

## 十八、回测系统需要支持的功能

### 基础功能
1. **K线数据处理**
   - 日K、周K、月K
   - 复权处理（前复权/后复权）

2. **技术指标计算**
   - 支持上述所有指标的计算
   - 自定义指标参数

3. **条件组合**
   - AND/OR逻辑
   - 多重条件嵌套
   - 时间条件（如"连续3天"）

4. **信号生成**
   - 买入信号
   - 卖出信号
   - 持仓管理

### 高级功能
1. **自然语言解析**
   - 识别指标名称（如"MACD金叉"）
   - 识别条件关系（如"大于"、"小于"、"上穿"）
   - 识别组合逻辑（如"同时"、"或者"）

2. **回测引擎**
   - 历史数据回放
   - 收益率计算
   - 最大回撤计算
   - 胜率/盈亏比统计
   - 交易明细记录

3. **可视化展示**
   - K线图叠加指标
   - 买卖点标注
   - 收益曲线
   - 回撤曲线
   - 统计图表

4. **策略优化**
   - 参数寻优
   - 策略对比
   - 风险评估

---

## 十九、自然语言示例

### 示例1：简单策略
```
用户输入：
"当5日均线上穿10日均线，并且MACD金叉时买入，
当5日均线下穿10日均线时卖出"

系统解析：
买入条件：MA(5) > MA(10) AND MACD_DIF > MACD_DEA
卖出条件：MA(5) < MA(10)
```

### 示例2：复杂策略
```
用户输入：
"当股价突破60日均线，成交量是前5日平均量的1.5倍以上，
KDJ在50以下金叉，RSI大于50时买入。
止损位为买入价的-8%，止盈位为+15%"

系统解析：
买入条件：
- CLOSE > MA(60)
- VOL > AVG(VOL, 5) * 1.5
- KDJ_K上穿KDJ_D AND KDJ_K < 50
- RSI(6) > 50
止损：-8%
止盈：+15%
```

### 示例3：形态策略
```
用户输入：
"当出现双底形态，突破颈线位，MACD在零轴上方，
成交量放大时买入"

系统解析：
（需要形态识别模块）
- 识别双底形态
- CLOSE > 颈线价格
- MACD_DIF > 0
- VOL > AVG(VOL, 20) * 1.2
```

---

## 二十、技术指标计算公式参考

### MA（移动平均）
```
MA(N) = SUM(CLOSE, N) / N
```

### EMA（指数移动平均）
```
EMA(N) = (2 * CLOSE + (N-1) * EMA(N-1)) / (N+1)
```

### MACD
```
DIF = EMA(CLOSE, 12) - EMA(CLOSE, 26)
DEA = EMA(DIF, 9)
MACD = (DIF - DEA) * 2
```

### KDJ
```
RSV = (CLOSE - MIN(LOW, N)) / (MAX(HIGH, N) - MIN(LOW, N)) * 100
K = SMA(RSV, M1)
D = SMA(K, M2)
J = 3 * K - 2 * D
```

### RSI
```
UP = MAX(CLOSE - CLOSE[1], 0)
DOWN = MAX(CLOSE[1] - CLOSE, 0)
RSI = 100 * SMA(UP, N) / (SMA(UP, N) + SMA(DOWN, N))
```

### BOLL
```
MID = MA(CLOSE, N)
STD = STDDEV(CLOSE, N)
UPPER = MID + K * STD
LOWER = MID - K * STD
```

---

## 总结

散户技术分析的核心在于：
1. **趋势判断**：均线系统、趋势线
2. **买卖时机**：MACD、KDJ、RSI等指标
3. **量价配合**：成交量分析
4. **风险控制**：支撑压力位、止损止盈

回测系统应该：
- 支持灵活的指标组合
- 提供直观的可视化
- 准确的回测计算
- 友好的自然语言交互

本文档为系统开发提供了全面的理论基础，可根据实际需求逐步实现各项功能。
